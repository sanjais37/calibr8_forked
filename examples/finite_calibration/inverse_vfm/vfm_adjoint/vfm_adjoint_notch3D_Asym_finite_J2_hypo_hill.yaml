inverse_notch3D_finite_J2_hypo_hill:

  problem:
    name: inverse_notch3D_Asym_finite_hypo_hill

  discretization:
    geom file: '/home/sk63837/calibr8/source/calibr8/test/mesh/notch3D_Asym/notch3D_Asym.dmg'
    mesh file: '../../forward/notch3D_Asym_finite_J2_hypo_hill_synthetic/'
    assoc file: '/home/sk63837/calibr8/source/calibr8/test/mesh/notch3D_Asym/notch3D_Asym.txt'
    num steps: 8
    step size: 1.

  residuals:
    global residual:
      type: 'mechanics'
      nonlinear max iters: 30
      nonlinear absolute tol: 1.e-12
      nonlinear relative tol: 1.e-12
      max line search evals: 50
      print convergence: false
    local residual:
      type: 'hypo_hill'
      nonlinear max iters: 500
      nonlinear absolute tol: 1.e-12
      nonlinear relative tol: 1.e-12
      materials:
        body:
          E: 200.e3
          nu: 0.30
          Y: 360.
          R00: 1.
          R11: 1.
          R22: 1.
          R01: 1.
          R02: 1.
          R12: 1.
          S: 920.
          D: 2.2

  # bc name: [resid_idx, eq, node_set_name, value]
  dirichlet bcs:
    expression:
      bc 1: [0, 0, ymin, 0.0]
      bc 2: [0, 1, ymin, 0.0]
      bc 3: [0, 2, zmin, 0.0]
      bc 4: [0, 1, ymax, 0.001 * t]


  inverse:
    objective type: "Adjoint_VFM"
    check gradient: false
    print vfm mismatch: false
    internal power scale factor: 1.
    objective scale factor: 1e2
    thickness: 1.
    load input file: "../../forward/load3D_hypo_hill.dat"
    gradient tolerance: 1e-8
    iteration limit: 300
    max line search evals: 50
    materials:
      body:
       #E:  [150.e3, 250.e3]
       #nu: [0.23, 0.35]
       Y:  [300., 370.]
       S:  [800., 1050.]
       D:  [2., 3.]

  virtual fields:
    w_x: 'sin(4*atan(1.)*(y-1.))'   #'cos(4. * atan(1.) * (y - 0.5) / 1.) * x'
    w_y: 'y*(y+1.)/2.'     #'(y * (2 * (y - 0.5) + 1.) / (2 * 1.))'
